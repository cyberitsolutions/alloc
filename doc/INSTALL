.. -*- mode: rst -*-

INSTALL
=======

NOTE: If you are upgrading, please read the UPGRADING section below.

allocPSA is generally intended to run with PHP and MySQL on a GNU/Linux
server.

On Debian you need to install these packages::

  apt-get install apache2 php php-pdo-mysql php-mbstring php-gd mariadb-server make python

On Alpine Linux you need these packages::

  apk add apache2 php php-dom php-gd php-mbstring php-pdo php-pdo_mysql php-simplexml php-xml mariadb make python2

Ensure mariadb is running in utf8 mode and not utf8mb4, see the config
files for mariadb in /etc/.

FIXME: these instructions are VERY OLD and OBSOLETE, for now see the
Dockerfile in the root dir for how we install alloc in a Docker
container.

To install allocPSA:

1. Put the allocPSA source code in a directory called e.g. ``alloc`` in your
   httpd servers document root. E.g.: ``/var/www/html/alloc/``

2. Make the patches and cache, e.g.::

     make patches; make cache

3. In a web browser, go to your servers hostname + directory where you put the
   alloc source code, such as: http://localhost/alloc/

4. Follow the instructions in the web browser to complete the installation.

UPGRADING
=========

NOTE: if you are upgrading to newer than 1.9.0, make sure you have
already upgraded to 1.9.0

FIXME: these instructions are VERY OLD.

To determine which version you are currently running, look at the fine print at
the bottom of the login screen for allocPSA, or alternatively view the file:
http://YOUR_ALLOC_INSTALLATION/util/alloc_version

Generic Upgrade Instructions
----------------------------

- Backup your allocPSA database. *DO IT NOW.*
- Unpack the new allocPSA source code alongside your current installation.
- Copy the ``alloc_config.php`` file from your current installation of
  allocPSA into the directory that contains the new installation of allocPSA.

- Finally, update your allocPSA database by going to this address in your web
  browser: http://YOUR_NEW_ALLOC_INSTALLATION/installation/patch.php

  Apply each patch separately, starting from the top and working your way
  down. If you get errors stop the process and use the support forums.
